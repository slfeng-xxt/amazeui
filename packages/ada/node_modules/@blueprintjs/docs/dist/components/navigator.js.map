{"version":3,"sources":["../src/components/navigator.tsx"],"names":[],"mappings":"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","file":"components/navigator.js","sourcesContent":["/*\n * Copyright 2017-present Palantir Technologies, Inc. All rights reserved.\n * Licensed under the BSD-3 License as modified (the “License”); you may obtain a copy\n * of the license at https://github.com/palantir/blueprint/blob/master/LICENSE\n * and https://github.com/palantir/blueprint/blob/master/PATENTS\n */\n\nimport {\n    Classes,\n    Hotkey,\n    Hotkeys,\n    HotkeysTarget,\n    IconContents,\n    InputGroup,\n    Keys,\n    Menu,\n    Popover,\n    Position,\n} from \"@blueprintjs/core\";\n\nimport * as classNames from \"classnames\";\nimport { IHeadingNode, IPageNode } from \"documentalist/dist/client\";\nimport { filter } from \"fuzzaldrin-plus\";\nimport * as React from \"react\";\nimport { findDOMNode } from \"react-dom\";\n\nimport { createKeyEventHandler, eachLayoutNode } from \"../common/utils\";\nimport { handleStringChange } from \"./baseExample\";\n\nexport interface INavigatorProps {\n    items: Array<IPageNode | IHeadingNode>;\n    onNavigate: (id: string) => void;\n}\n\nexport interface INavigatorState {\n    query: string;\n    selectedIndex: number;\n}\n\ninterface INavigationSection {\n    filterKey: string;\n    path: string[];\n    route: string;\n    title: string;\n}\n\n@HotkeysTarget\nexport class Navigator extends React.PureComponent<INavigatorProps, INavigatorState> {\n    public state: INavigatorState = {\n        query: \"\",\n        selectedIndex: 0,\n    };\n\n    private inputRef: HTMLElement;\n\n    // this guy must be defined before he's used in handleQueryChange\n    // and it just makes sense to be up here with state init\n    // tslint:disable:member-ordering\n    private resetState = (query = \"\") => this.setState({ query, selectedIndex: 0 });\n    private sections: INavigationSection[];\n\n    private handleQueryChange = handleStringChange(this.resetState);\n    private handleKeyDown = createKeyEventHandler({\n        [Keys.ARROW_DOWN]: this.selectNext(),\n        [Keys.ARROW_UP]: this.selectNext(-1),\n        [Keys.ENTER]: () => {\n            const activeItem = findDOMNode(this).query(`.${Classes.MENU_ITEM}.${Classes.ACTIVE}`) as HTMLElement;\n            if (activeItem != null) {\n                activeItem.click();\n            }\n        },\n    });\n\n    public render() {\n        return (\n            <Popover\n                autoFocus={false}\n                enforceFocus={false}\n                className=\"docs-navigator\"\n                content={this.renderPopover()}\n                onInteraction={this.handlePopoverInteraction}\n                inline={true}\n                isOpen={this.state.query.length > 0}\n                popoverClassName={Classes.MINIMAL}\n                position={Position.BOTTOM_LEFT}\n            >\n                <InputGroup\n                    autoFocus={true}\n                    inputRef={this.handleSetSearchInputRef}\n                    leftIconName=\"search\"\n                    onChange={this.handleQueryChange}\n                    onKeyDown={this.handleKeyDown}\n                    placeholder=\"Search...\"\n                    type=\"search\"\n                    value={this.state.query}\n                />\n            </Popover>\n        );\n    }\n\n    public renderHotkeys() {\n         return <Hotkeys>\n             <Hotkey\n                 global={true}\n                 combo=\"shift + s\"\n                 label=\"Focus documentation search box\"\n                 onKeyDown={this.handleFocusSearch}\n             />\n         </Hotkeys>;\n    }\n\n    public componentDidMount() {\n        this.sections = [];\n        eachLayoutNode(this.props.items, (node, parents) => {\n            const { route, title } = node;\n            const path = parents.map((p) => p.title).reverse();\n            const filterKey = [...path, title].join(\"/\");\n            this.sections.push({ filterKey, path, route, title });\n        });\n    }\n\n    private getMatches() {\n        return filter(this.sections, this.state.query, {\n            key: \"filterKey\",\n        });\n    }\n\n    private renderPopover() {\n        const matches = this.getMatches();\n        const selectedIndex = Math.min(matches.length, this.state.selectedIndex);\n        let items = matches.map((section, index) => {\n            const isSelected = index === selectedIndex;\n            const classes = classNames(Classes.MENU_ITEM, Classes.POPOVER_DISMISS, {\n                [Classes.ACTIVE]: isSelected,\n                [Classes.INTENT_PRIMARY]: isSelected,\n            });\n            const headerHtml = { __html: section.title };\n            // add $icons16-family to font stack to support mixing icons with regular text!\n            const pathHtml = { __html: section.path.join(IconContents.CARET_RIGHT) };\n            return (\n                <a\n                    className={classes}\n                    href={\"#\" + section.route}\n                    key={section.route}\n                    onMouseEnter={this.handleResultHover}\n                >\n                    <small className=\"docs-result-path pt-text-muted\" dangerouslySetInnerHTML={pathHtml} />\n                    <div dangerouslySetInnerHTML={headerHtml} />\n                </a>\n            );\n        });\n        if (items.length === 0) {\n            items = [\n                <a className={classNames(Classes.MENU_ITEM, Classes.DISABLED)} key=\"none\">\n                    No results. Press <code>esc</code> to reset.\n                </a>,\n            ];\n        }\n        return <Menu>{items}</Menu>;\n    }\n\n    private handleFocusSearch = (e: KeyboardEvent) => {\n        if (this.inputRef != null) {\n            e.preventDefault();\n            this.inputRef.focus();\n        }\n    }\n\n    private handleSetSearchInputRef = (ref: Element) => {\n        this.inputRef = ref as HTMLElement;\n    }\n\n    private handlePopoverInteraction = (nextOpenState: boolean) => {\n        if (!nextOpenState) {\n            this.resetState();\n        }\n    }\n\n    private handleResultHover = (e: React.MouseEvent<HTMLAnchorElement>) => {\n        const el = e.currentTarget as HTMLElement;\n        if (el.parentElement != null) {\n            const selectedIndex: number = Array.prototype.indexOf.call(el.parentElement.children, el);\n            this.setState({ ...this.state, selectedIndex });\n        }\n    }\n\n    private selectNext(direction = 1) {\n        return () => this.setState({\n            ...this.state,\n            selectedIndex: Math.max(0, this.state.selectedIndex + direction),\n        });\n    }\n}\n"]}
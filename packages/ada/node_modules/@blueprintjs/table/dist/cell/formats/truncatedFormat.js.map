{"version":3,"sources":["../src/cell/formats/truncatedFormat.tsx"],"names":[],"mappings":"AAAA;;;;;GAKG;;;;AAEH,0CAAsF;AAEtF,uCAAyC;AACzC,6BAA+B;AAE/B,8CAAgD;AAEhD,IAAY,oBAIX;AAJD,WAAY,oBAAoB;IAC5B,mEAAM,CAAA;IACN,iEAAK,CAAA;IACL,mFAAc,CAAA;AAClB,CAAC,EAJW,oBAAoB,GAApB,4BAAoB,KAApB,4BAAoB,QAI/B;AAkDD;IAAqC,2CAA6D;IAAlG;QAAA,qEAoGC;QA3FU,WAAK,GAA0B,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;QA4DrD,yBAAmB,GAAG,UAAC,GAAmB,IAAK,OAAA,KAAI,CAAC,UAAU,GAAG,GAAG,EAArB,CAAqB,CAAC;;IA+BjF,CAAC;IAvFU,gCAAM,GAAb;QACU,IAAA,eAA2F,EAAzF,sBAAQ,EAAE,sCAAgB,EAAE,8BAAY,EAAE,kCAAc,EAAE,sCAAgB,CAAgB;QAClG,IAAM,OAAO,GAAG,EAAE,GAAG,QAAQ,CAAC;QAE9B,IAAI,WAAW,GAAG,OAAO,CAAC;QAC1B,EAAE,CAAC,CAAC,CAAC,gBAAgB,IAAI,cAAc,GAAG,CAAC,IAAI,WAAW,CAAC,MAAM,GAAG,cAAc,CAAC,CAAC,CAAC;YACjF,WAAW,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,cAAc,CAAC,GAAG,gBAAgB,CAAC;QAC9E,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAClC,IAAM,cAAc,GAAG,UAAU,CAC7B,OAAO,CAAC,uBAAuB,EAC/B,YAAY,GAAG,OAAO,CAAC,4BAA4B,GAAG,OAAO,CAAC,+BAA+B,CAChG,CAAC;YACF,IAAM,cAAc,GAAG,6BAAK,SAAS,EAAE,cAAc,IAAG,QAAQ,CAAO,CAAC;YACxE,IAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;YACnF,IAAM,WAAW,GAAG,CAAC;oBACjB,UAAU,EAAE,UAAU;oBACtB,GAAG,EAAE,IAAI;oBACT,EAAE,EAAE,QAAQ;iBACf,CAAC,CAAC;YAEH,IAAM,WAAW,GAAG,UAAU,CAC1B,cAAW,CAAC,aAAa,EACzB,cAAW,CAAC,SAAS,CAAC,MAAM,CAAC,CAChC,CAAC;YAEF,MAAM,CAAC,CACH,6BAAK,SAAS,EAAE,SAAS;gBACrB,6BAAK,SAAS,EAAE,OAAO,CAAC,qBAAqB,EAAE,GAAG,EAAE,IAAI,CAAC,mBAAmB,IAAG,WAAW,CAAO;gBACjG,oBAAC,cAAO,IACJ,SAAS,EAAE,OAAO,CAAC,8BAA8B,EACjD,aAAa,EAAE,EAAE,WAAW,aAAA,EAAE,EAC9B,OAAO,EAAE,cAAc,EACvB,QAAQ,EAAE,eAAQ,CAAC,MAAM,EACzB,wBAAwB,QACxB,mBAAmB;oBAEnB,8BAAM,SAAS,EAAE,WAAW,GAAG,CACzB,CACR,CACT,CAAC;QACN,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,OAAO,CAAC,oBAAoB,CAAC,CAAC;YACjF,MAAM,CAAC,6BAAK,SAAS,EAAE,SAAS,EAAE,GAAG,EAAE,IAAI,CAAC,mBAAmB,IAAG,WAAW,CAAO,CAAC;QACzF,CAAC;IACL,CAAC;IAEM,2CAAiB,GAAxB;QACI,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC9B,CAAC;IAEM,4CAAkB,GAAzB;QACI,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC9B,CAAC;IAIO,2CAAiB,GAAzB,UAA0B,OAAe;QAC/B,IAAA,eAA8D,EAA5D,sCAAgB,EAAE,4BAAW,EAAE,kCAAc,CAAgB;QAErE,MAAM,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;YAClB,KAAK,oBAAoB,CAAC,MAAM;gBAC5B,MAAM,CAAC,IAAI,CAAC;YAChB,KAAK,oBAAoB,CAAC,KAAK;gBAC3B,MAAM,CAAC,KAAK,CAAC;YACjB,KAAK,oBAAoB,CAAC,cAAc;gBACpC,MAAM,CAAC,gBAAgB;sBACjB,IAAI,CAAC,KAAK,CAAC,WAAW;sBACtB,CAAC,cAAc,GAAG,CAAC,IAAI,OAAO,CAAC,MAAM,GAAG,cAAc,CAAC,CAAC;YAClE;gBACI,MAAM,CAAC,KAAK,CAAC;QACrB,CAAC;IACL,CAAC;IAEO,4CAAkB,GAA1B;QACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC;YAC/B,MAAM,CAAC;QACX,CAAC;QAED,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,KAAK,SAAS;YAC7C,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW;gBAC1D,IAAI,CAAC,UAAU,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;QACjE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,KAAK,WAAW,CAAC,CAAC,CAAC;YACzC,IAAI,CAAC,QAAQ,CAAC,EAAE,WAAW,aAAA,EAAE,CAAC,CAAC;QACnC,CAAC;IACL,CAAC;IACL,sBAAC;AAAD,CApGA,AAoGC,CApGoC,KAAK,CAAC,SAAS;AAClC,4BAAY,GAA0B;IAChD,gBAAgB,EAAE,IAAI;IACtB,YAAY,EAAE,KAAK;IACnB,WAAW,EAAE,oBAAoB,CAAC,cAAc;IAChD,cAAc,EAAE,EAAE;IAClB,gBAAgB,EAAE,KAAK;CAC1B,CAAC;AAPO,0CAAe","file":"cell/formats/truncatedFormat.js","sourcesContent":["/**\n * Copyright 2016 Palantir Technologies, Inc. All rights reserved.\n * Licensed under the BSD-3 License as modified (the “License”); you may obtain a copy\n * of the license at https://github.com/palantir/blueprint/blob/master/LICENSE\n * and https://github.com/palantir/blueprint/blob/master/PATENTS\n */\n\nimport { Classes as CoreClasses, IProps, Popover, Position } from \"@blueprintjs/core\";\n\nimport * as classNames from \"classnames\";\nimport * as React from \"react\";\n\nimport * as Classes from \"../../common/classes\";\n\nexport enum TruncatedPopoverMode {\n    ALWAYS,\n    NEVER,\n    WHEN_TRUNCATED,\n}\n\nexport interface ITruncatedFormatProps extends IProps {\n    children?: string;\n\n    /**\n     * Should the component keep track of the truncation state of the string content. If true, the\n     * value of `truncateLength` is ignored. When combined with a `showPopover` value of\n     * `WHEN_TRUNCATED`, popovers will only render when necessary.\n     * @default true;\n     */\n    detectTruncation?: boolean;\n\n    /**\n     * Sets the popover content style to `white-space: pre` if `true` or\n     * `white-space: normal` if `false`.\n     * @default false\n     */\n    preformatted?: boolean;\n\n    /**\n     * Configures when the popover is shown with the `TruncatedPopoverMode` enum.\n     *\n     * The enum values are:\n     * - `ALWAYS`: show the popover (default).\n     * - `NEVER`: don't show the popover.\n     * - `WHEN_TRUNCATED`: show the popover only when the text is truncated.\n     * @default WHEN_TRUNCATED\n     */\n    showPopover?: TruncatedPopoverMode;\n\n    /**\n     * Number of characters that are displayed before being truncated and appended with the\n     * `truncationSuffix` prop. A value of 0 will disable truncation. This prop is ignored if\n     * `detectTruncation` is `true`.\n     * @default 80\n     */\n    truncateLength?: number;\n\n    /**\n     * The string that is appended to the display string if it is truncated.\n     * @default \"...\"\n     */\n    truncationSuffix?: string;\n}\n\nexport interface ITruncatedFormatState {\n    isTruncated: boolean;\n}\n\nexport class TruncatedFormat extends React.Component<ITruncatedFormatProps, ITruncatedFormatState> {\n    public static defaultProps: ITruncatedFormatProps = {\n        detectTruncation: true,\n        preformatted: false,\n        showPopover: TruncatedPopoverMode.WHEN_TRUNCATED,\n        truncateLength: 80,\n        truncationSuffix: \"...\",\n    };\n\n    public state: ITruncatedFormatState = { isTruncated: false };\n\n    private contentDiv: HTMLDivElement;\n\n    public render() {\n        const { children, detectTruncation, preformatted, truncateLength, truncationSuffix } = this.props;\n        const content = \"\" + children;\n\n        let cellContent = content;\n        if (!detectTruncation && truncateLength > 0 && cellContent.length > truncateLength) {\n            cellContent = cellContent.substring(0, truncateLength) + truncationSuffix;\n        }\n\n        if (this.shouldShowPopover(content)) {\n            const popoverClasses = classNames(\n                Classes.TABLE_TRUNCATED_POPOVER,\n                preformatted ? Classes.TABLE_POPOVER_WHITESPACE_PRE : Classes.TABLE_POPOVER_WHITESPACE_NORMAL,\n            );\n            const popoverContent = <div className={popoverClasses}>{children}</div>;\n            const className = classNames(this.props.className, Classes.TABLE_TRUNCATED_FORMAT);\n            const constraints = [{\n                attachment: \"together\",\n                pin: true,\n                to: \"window\",\n            }];\n\n            const iconClasses = classNames(\n                CoreClasses.ICON_STANDARD,\n                CoreClasses.iconClass(\"more\"),\n            );\n\n            return (\n                <div className={className}>\n                    <div className={Classes.TABLE_TRUNCATED_VALUE} ref={this.handleContentDivRef}>{cellContent}</div>\n                    <Popover\n                        className={Classes.TABLE_TRUNCATED_POPOVER_TARGET}\n                        tetherOptions={{ constraints }}\n                        content={popoverContent}\n                        position={Position.BOTTOM}\n                        useSmartArrowPositioning\n                        useSmartPositioning\n                    >\n                        <span className={iconClasses}/>\n                    </Popover>\n                </div>\n            );\n        } else {\n            const className = classNames(this.props.className, Classes.TABLE_TRUNCATED_TEXT);\n            return <div className={className} ref={this.handleContentDivRef}>{cellContent}</div>;\n        }\n    }\n\n    public componentDidMount() {\n        this.setTruncationState();\n    }\n\n    public componentDidUpdate() {\n        this.setTruncationState();\n    }\n\n    private handleContentDivRef = (ref: HTMLDivElement) => this.contentDiv = ref;\n\n    private shouldShowPopover(content: string) {\n        const { detectTruncation, showPopover, truncateLength } = this.props;\n\n        switch (showPopover) {\n            case TruncatedPopoverMode.ALWAYS:\n                return true;\n            case TruncatedPopoverMode.NEVER:\n                return false;\n            case TruncatedPopoverMode.WHEN_TRUNCATED:\n                return detectTruncation\n                    ? this.state.isTruncated\n                    : (truncateLength > 0 && content.length > truncateLength);\n            default:\n                return false;\n        }\n    }\n\n    private setTruncationState() {\n        if (!this.props.detectTruncation) {\n            return;\n        }\n\n        const isTruncated = this.contentDiv !== undefined &&\n            (this.contentDiv.scrollWidth > this.contentDiv.clientWidth ||\n            this.contentDiv.scrollHeight > this.contentDiv.clientHeight);\n        if (this.state.isTruncated !== isTruncated) {\n            this.setState({ isTruncated });\n        }\n    }\n}\n"]}